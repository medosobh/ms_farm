<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="farm_projects_view_form" model="ir.ui.view">
        <field name="name">farm.projects.form</field>
        <field name="model">farm.projects</field>
        <field name="arch" type="xml">
            <form string="Project">
                <header>
                    <button name="button_draft" string="Set Draft" type="object" class="oe_highlight"
                            help="Move Project to In Draft State" states="on_hold"/>
                    <button name="button_in_operation" string="Set In Operation" type="object" class="oe_highlight"
                            help="Move Project to In operation State" states="draft,finish"/>
                    <button name="button_finish" string="Set Finish" type="object" class="oe_highlight"
                            help="Move Project to In Finish State" states="in_operation"/>
                    <button name="button_on_hold" string="Set On hold" type="object" class="oe_highlight"
                            help="Move Project to On Hold State" states="in_operation"/>
                    <field name="state" widget="statusbar" options="{'clickable': '0'}" clickable="True" type="object"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_open_operation_orders_timeframe" type="object"
                                class="oe_stat_button"
                                icon="fa-calendar">
                            <div class="o_stat_info">
                                <field name="operations_count"/>
                                <span class="o_stat_text">Operation TF</span>
                            </div>
                        </button>
                        <button name="action_open_material_orders_timeframe" type="object"
                                class="oe_stat_button"
                                icon="fa-calendar">
                            <div class="o_stat_info">
                                <field name="materials_count"/>
                                <span class="o_stat_text">Material TF</span>
                            </div>
                        </button>
                        <button name="action_open_expense_orders_timeframe" type="object"
                                class="oe_stat_button"
                                icon="fa-calendar">
                            <div class="o_stat_info">
                                <field name="expenses_count"/>
                                <span class="o_stat_text">Expense TF</span>
                            </div>
                        </button>
                        <button name="action_open_produce_orders_timeframe" type="object"
                                class="oe_stat_button"
                                icon="fa-calendar">
                            <div class="o_stat_info">
                                <field name="produce_count"/>
                                <span class="o_stat_text">Produce TF</span>
                            </div>
                        </button>
                        <button name="action_open_sales_orders_timeframe" type="object"
                                class="oe_stat_button"
                                icon="fa-calendar">
                            <div class="o_stat_info">
                                <field name="sales_count"/>
                                <span class="o_stat_text">Sales TF</span>
                            </div>
                        </button>
                    </div>
                    <div class="oe_title">
                        <h3>
                            <field name="priority" widget="priority" class="mr-3"/>
                            <field name="name"/>
                            <separator/>
                            <field name="short_name"/>
                        </h3>
                    </div>
                    <group>
                        <group string="Basic">
                            <field name="project_type"/>
                            <field name="project_group_id" widget="selection"/>
                            <field name="user_id" widget="selection"/>
                            <field name="description"/>
                            <field name="active" invisible="1"/>
                            <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                            <field name="currency_id" widget="selection"/>
                            <field name="analytic_account_id"/>
                        </group>
                        <group string="Time Frame">
                            <field name="start_date" type="date" class="oe_inline"/>
                            <field name="end_date" type="date" class="oe_inline"/>
                            <field name="close_date" type="date" class="oe_inline"/>
                            <field name="time_progress" widget="progressbar">Time</field>
                            <field name="cost_progress" widget="progressbar">Cost</field>
                        </group>
                    </group>
                    <notebook string="Details">
                        <page string="Operation Orders">
                            <field name="operations_ids" context="{'default_user_id': user_id}">
                                <tree>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="category_id"/>
                                    <field name="user_id" widget="selection"/>
                                    <field name="activity_ids" widget="list_activity"/>
                                    <field name="issue_date"/>
                                    <field name="o_order_cost" widget="monetary"/>
                                    <field name="currency_id" groups="base.group_multi_currency" widget="selection"/>
                                    <field name="partner_id" widget="selection"/>
                                    <field name="stock_warehouse" widget="selection"/>
                                </tree>
                                <form>
                                    <group>
                                        <group>
                                            <field name="name"/>
                                            <field name="short_name"/>
                                            <field name="category_id"/>
                                        </group>
                                        <group string="Basic">
                                            <field name="user_id" widget="selection"/>
                                            <field name="issue_date"/>
                                            <field name="o_order_cost" widget="monetary"/>
                                            <field name="active" invisible="1"/>
                                            <field name="company_id" groups="base.group_multi_company"
                                                   widget="selection"/>
                                            <field name="currency_id" groups="base.group_multi_currency"
                                                   widget="selection"/>
                                            <field name="partner_id" widget="selection"/>
                                            <field name="stock_warehouse" widget="selection"/>
                                        </group>
                                    </group>
                                    <field name="operation_order_line_ids" readonly="1">
                                        <tree>
                                            <field name="sequence" widget="handle"/>
                                            <field name="product_id" widget="selection"/>
                                            <field name="name" widget="section_and_note_text"/>
                                            <field name="categ_id" widget="selection" invisible="1"/>
                                            <field name="price_unit" widget="monetary"/>
                                            <field name="currency_id" invisible="1" widget="selection"/>
                                            <field name="product_uom"/>
                                            <field name="qty"/>
                                            <field name="note"/>
                                            <field name="price_subtotal" sum="Total Cost"/>
                                        </tree>
                                    </field>
                                </form>
                            </field>
                        </page>
                        <page string="Material Orders">
                            <field name="materials_ids" context="{'default_user_id': user_id}">
                                <tree>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="category_id"/>
                                    <field name="user_id" widget="selection"/>
                                    <field name="activity_ids" widget="list_activity"/>
                                    <field name="issue_date"/>
                                    <field name="m_order_cost" widget="monetary"/>
                                    <field name="currency_id" groups="base.group_multi_currency" widget="selection"/>
                                    <field name="partner_id" widget="selection"/>
                                    <field name="stock_warehouse" widget="selection"/>
                                </tree>
                                <form>
                                    <group>
                                        <group>
                                            <field name="name"/>
                                            <field name="short_name"/>
                                            <field name="category_id"/>
                                        </group>
                                        <group string="Basic">
                                            <field name="user_id" widget="selection"/>
                                            <field name="issue_date"/>
                                            <field name="m_order_cost" widget="monetary"/>
                                            <field name="active" invisible="1"/>
                                            <field name="company_id" groups="base.group_multi_company"
                                                   widget="selection"/>
                                            <field name="currency_id" groups="base.group_multi_currency"
                                                   widget="selection"/>
                                            <field name="partner_id" widget="selection"/>
                                            <field name="stock_warehouse" widget="selection"/>
                                        </group>
                                    </group>
                                    <field name="materials_order_line_ids" readonly="1">
                                        <tree editable="bottom">
                                            <field name="sequence" widget="handle"/>
                                            <field name="product_id" widget="selection"/>
                                            <field name="name" widget="section_and_note_text"/>
                                            <field name="categ_id" widget="selection" invisible="1"/>
                                            <field name="price_unit" widget="monetary"/>
                                            <field name="currency_id" invisible="1" widget="selection"/>
                                            <field name="product_uom"/>
                                            <field name="qty"/>
                                            <field name="note"/>
                                            <field name="price_subtotal" sum="Total Cost"/>
                                        </tree>
                                    </field>
                                </form>
                            </field>
                        </page>
                        <page string="Expense Budget">
                            <field name="expenses_ids" context="{'default_user_id': user_id}">
                                <tree>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="category_id"/>
                                    <field name="user_id" widget="selection"/>
                                    <field name="activity_ids" widget="list_activity"/>
                                    <field name="issue_date"/>
                                    <field name="e_order_cost" widget="monetary"/>
                                    <field name="currency_id" groups="base.group_multi_currency" widget="selection"/>
                                    <field name="partner_id" widget="selection"/>
                                    <field name="stock_warehouse" widget="selection"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Produce Order">
                            <field name="produce_ids" context="{'default_user_id': user_id}">
                                <tree>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="short_name"/>
                                    <field name="user_id" widget="selection"/>
                                    <field name="activity_ids" widget="list_activity"/>
                                    <field name="issue_date"/>
                                    <field name="p_order_cost" sum="Total Order"/>
                                    <field name="partner_id" widget="selection"/>
                                    <field name="stock_warehouse" widget="selection"/>
                                </tree>
                                <form>
                                    <group>
                                        <group>
                                            <field name="name"/>
                                            <field name="short_name"/>
                                        </group>
                                        <group string="Basic">
                                            <field name="user_id" widget="selection"/>
                                            <field name="issue_date"/>
                                            <field name="p_order_cost" widget="monetary"/>
                                            <field name="active" invisible="1"/>
                                            <field name="company_id" groups="base.group_multi_company"/>
                                            <field name="currency_id" groups="base.group_multi_currency"/>
                                            <field name="partner_id" widget="selection"/>
                                            <field name="stock_warehouse" widget="selection"/>
                                        </group>
                                    </group>
                                    <field name="produce_order_line_ids" readonly="1">
                                        <tree>
                                            <field name="sequence" widget="handle"/>
                                            <field name="product_id" widget="selection"/>
                                            <field name="name" widget="section_and_note_text"/>
                                            <field name="categ_id" widget="selection" invisible="1"/>
                                            <field name="price_unit" widget="monetary"/>
                                            <field name="currency_id" invisible="1"/>
                                            <field name="product_uom"/>
                                            <field name="qty"/>
                                            <field name="note"/>
                                            <field name="price_subtotal" sum="Total Cost"/>
                                        </tree>
                                    </field>
                                </form>
                            </field>
                        </page>
                        <page string="Sales Order">
                            <field name="sales_ids" context="{'default_user_id': user_id}">
                                <tree>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="short_name"/>
                                    <field name="user_id" widget="selection"/>
                                    <field name="activity_ids" widget="list_activity"/>
                                    <field name="issue_date"/>
                                    <field name="s_order_cost" sum="Total Order"/>
                                    <field name="partner_id" widget="selection"/>
                                    <field name="stock_warehouse" widget="selection"/>
                                </tree>
                                <form>
                                    <group>
                                        <group>
                                            <field name="name"/>
                                            <field name="short_name"/>
                                        </group>
                                        <group string="Basic">
                                            <field name="user_id" widget="selection"/>
                                            <field name="issue_date"/>
                                            <field name="s_order_cost" widget="monetary"/>
                                            <field name="active" invisible="1"/>
                                            <field name="company_id" groups="base.group_multi_company"
                                                   widget="selection"/>
                                            <field name="currency_id" groups="base.group_multi_currency"
                                                   widget="selection"/>
                                            <field name="partner_id" widget="selection"/>
                                            <field name="stock_warehouse" widget="selection"/>
                                        </group>
                                    </group>
                                    <field name="sales_order_line_ids" readonly="1">
                                        <tree>
                                            <field name="sequence" widget="handle"/>
                                            <field name="product_id" widget="selection"/>
                                            <field name="name" widget="section_and_note_text"/>
                                            <field name="categ_id" widget="selection" invisible="1"/>
                                            <field name="price_unit" widget="monetary"/>
                                            <field name="currency_id" invisible="1" widget="selection"/>
                                            <field name="product_uom"/>
                                            <field name="qty"/>
                                            <field name="note"/>
                                            <field name="price_subtotal" sum="Total Cost"/>
                                        </tree>
                                    </field>
                                </form>
                            </field>
                        </page>
                        <page string="Locations">
                            <field name="locations_used_ids">
                                <tree>
                                    <field name="locations_id" widget="selection"/>
                                    <field name="complete_name" widget="selection"/>
                                    <field name="address" widget="selection"/>
                                    <field name="space_sum" sum="Total Space"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="locations_id" widget="selection"/>
                                        <field name="space_sum" readonly="1"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="Summary">
                            <group>
                                <group name="Budget">
                                    <field name="operation_budget" widget='monetary'/>
                                    <field name="material_budget" widget='monetary'/>
                                    <field name="expense_budget" widget='monetary'/>
                                    <field name="total_budget" widget='monetary'/>
                                    <field name="plan_produce_amount" widget='monetary'/>
                                    <field name="plan_produce_qty"/>
                                    <field name="plan_sales_amount" widget='monetary'/>
                                    <field name="plan_sales_qty"/>
                                    <field name="p_days" string="Plan Days"/>
                                </group>
                                <group name="Actual">
                                    <field name="operations_actual" widget='monetary'/>
                                    <field name="materials_actual" widget='monetary'/>
                                    <field name="expenses_actual" widget='monetary'/>
                                    <field name="actual_produce_amount" widget='monetary'/>
                                    <field name="actual_produce_qty"/>
                                    <field name="actual_sales_amount" widget='monetary'/>
                                    <field name="actual_sales_qty"/>
                                    <field name="a_days" String="Actual Days"/>
                                </group>
                            </group>

                        </page>
                        <page string="KPIs">
                            <group>
                                <div>
                                    <field name="g_days" widget="gauge"
                                           options="{'max_field': 'p_days', 'label_field': 'Days Gone', 'style': 'width:160px; height: 120px;'}"/>
                                </div>
                                <div>
                                    <field name="total_actual" widget="gauge"
                                           options="{'max_field': 'total_budget', 'label_field': 'Days Gone', 'style': 'width:160px; height: 120px;'}"/>
                                </div>
                            </group>
                        </page>
                        <page string="Settings">
                            <group string="Product and Category">
                                <group>
                                    <field name="product_id"/>
                                    <field name="buy_sell_price" class="oe_inline"/>
                                    <field name="category_id" widget="selection" class="oe_inline"/>
                                </group>
                                <group>
                                    <div>
                                        <button name="create_project_product" type="object"
                                                string="Create Product"
                                                class="oe_highlight"
                                                attrs="{'invisible':[('product_id','!=', False)]}"/>
                                    </div>
                                    <div>
                                        <button name="update_project_product_price_unit"
                                                string="Re/Link and Update Price Unit"
                                                type="object"/>
                                    </div>
                                </group>
                            </group>
                            <group string="Analytic Account">
                                <group>
                                  <field name="analytic_account_id"/>
                                </group>
                                <group>
                                    <div>
                                        <button name="create_project_analytic_account" type="object"
                                                string="Create Analytic Account"
                                                class="oe_highlight"
                                                attrs="{'invisible':[('analytic_account_id','!=', False)]}"/>
                                    </div>
                                </group>
                            </group>

                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <record id="quick_create_farm_projects_view_form" model="ir.ui.view">
        <field name="name">farm.projects.form.quick_create</field>
        <field name="model">farm.projects</field>
        <field name="arch" type="xml">
            <form string="Project">
                <sheet>
                    <group>
                        <field name="priority" widget="priority" class="mr-3"/>
                        <field name="name"/>
                        <separator/>
                        <field name="short_name"/>
                        <group string="Basic">
                            <field name="project_type"/>
                            <field name="project_group_id" widget="selection"/>
                            <field name="user_id" widget="selection"/>
                            <field name="description"/>
                            <field name="active" invisible="1"/>
                            <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                            <field name="currency_id" widget="selection"/>
                        </group>
                        <group string="Time Frame">
                            <field name="start_date" type="date" class="oe_inline"/>
                            <field name="end_date" type="date" class="oe_inline"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="farm_projects_view_tree" model="ir.ui.view">
        <field name="name">farm.projects.tree</field>
        <field name="model">farm.projects</field>
        <field name="arch" type="xml">
            <tree string="Project" sample="1" decoration-info="state == 'draft'"
                  decoration-warning="state == 'in_operation'" decoration-success="state == 'finish'"
                  decoration-danger="state == 'on_hold'">
                <field name="name"/>
                <field name="priority" widget="priority" class="mr-3"/>
                <field name="state" widget="badge" decoration-info="state == 'draft'"
                       decoration-warning="state == 'in_operation'" decoration-success="state == 'finish'"
                       decoration-danger="state == 'on_hold'"/>
                <field name="activity_ids" widget="list_activity"/>
                <field name="project_type" optional="show"/>
                <field name="project_group_id" optional="show"/>
                <field name="short_name"/>
                <field name="user_id" widget="selection"/>
                <field name="description" optional="show"/>
                <field name="start_date" type="date"/>
                <field name="end_date" type="date"/>
                <field name="close_date" type="date" optional="hide"/>
                <field name="p_days" optional="hide"/>
                <field name="g_days" optional="hide"/>
                <field name="a_days" optional="hide"/>
                <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                <field name="currency_id" widget="selection"/>
            </tree>
        </field>
    </record>

    <record id="farm_projects_view_kanban" model="ir.ui.view">
        <field name="name">farm.projects.kanban</field>
        <field name="model">farm.projects</field>
        <field name="arch" type="xml">
            <kanban default_group_by="state"
                    class="o_kanban_small_column o_kanban_project_tasks"
                    sample="1"
                    on_create="quick_create"
                    quick_create_view="ms_farm.quick_create_farm_projects_view_form">
                <field name="state"/>
                <field name="priority" widget="priority" class="mr-3"/>
                <field name="name"/>
                <field name="project_type"/>
                <field name="short_name"/>
                <field name="user_id" widget="selection"/>
                <field name="description"/>
                <field name="start_date" type="date"/>
                <field name="end_date" type="date"/>
                <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_global_click">
                            <div class="oe_kanban_details">
                                <ul>
                                    <li>
                                        <field name="priority" widget="priority" class="mr-3"/>
                                    </li>
                                    <li>
                                        Ref:
                                        <field name="name"/>
                                    </li>
                                    <li>
                                        Name:
                                        <field name="short_name"/>
                                    </li>
                                    <li>
                                        <field name="user_id" widget="selection"/>
                                    </li>
                                    <li>
                                        Type:
                                        <field name="project_type"/>
                                        Group:
                                        <field name="project_group_id"/>
                                    </li>
                                    <li>
                                        Start:
                                        <field name="start_date"/>
                                        End:
                                        <field name="start_date"/>
                                    </li>
                                </ul>
                            </div>
                            <li>
                                Time Progress:
                                <field name="time_progress" widget="progressbar"/>
                                Cost Progress:
                                <field name="cost_progress" widget="progressbar">Cost</field>
                            </li>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="farm_projects_view_calendar" model="ir.ui.view">
        <field name="name">farm.projects.calendar</field>
        <field name="model">farm.projects</field>
        <field name="arch" type="xml">
            <calendar string="Projects" date_start="start_date" date_stop="end_date" create="1" quick_add="False"
                      mode="month" color="project_group_id" hide_time="true" event_limit="5"
                      form_view_id="%(quick_create_farm_projects_view_form)d" event_open_popup="False">
                <field name="project_type" filters="1" invisible="1"/>
                <field name="project_group_id" filters="1" invisible="1"/>
                <field name="user_id" filters="1" invisible="1"/>
                <field name="name"/>
                <field name="short_name"/>
                <field name="company_id" widget="selection" groups="base.group_multi_company" invisible="1"/>
            </calendar>
        </field>
    </record>

    <record id="farm_projects_view_search" model="ir.ui.view">
        <field name="name">farm.projects.search</field>
        <field name="model">farm.projects</field>
        <field name="arch" type="xml">
            <search string="Project">
                <field name="name"/>
                <field name="short_name"/>
                <field name="project_type"/>
                <field name="project_group_id"/>
                <field name="user_id" widget="selection"/>
                <field name="description"/>
                <field name="start_date" type="date"/>
                <field name="end_date" type="date"/>
                <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                <filter name="filter_create" string="Create Asset" domain="[('project_type', '=', 'create')]"/>
                <filter name="filter_operate" string="Operate Asset" domain="[('project_type', '=', 'operate')]"/>
                <separator/>
                <filter name="filter_archived" string="Archived" domain="[('active', '=', False)]"/>
                <separator/>
                <filter name="filter_draft" string="Draft" domain="[('state', '=', 'draft')]"/>
                <filter name="filter_in_operation" string="In Operation" domain="[('state', '=', 'in_operation')]"/>
                <filter name="filter_finish" string="Finished" domain="[('state', '=', 'finish')]"/>
                <filter name="filter_on_hold" string="On Hold" domain="[('state', '=', 'on_hold')]"/>
                <separator/>
                <group expand="0" string="Group by">
                    <filter string="Group" name="group_by_group" context="{'group_by':'project_group_id'}"/>
                    <filter string="Company" name="group_by_company" context="{'group_by':'company_id'}"/>
                </group>
                <searchpanel>
                    <field name="project_group_id" select="multi" string="Project Group" enable_counters="1"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <record id="farm_projects_action" model="ir.actions.act_window">
        <field name="name">Farm Projects</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">farm.projects</field>
        <field name="view_mode">kanban,tree,form,calendar</field>
        <field name="context">{}</field>
        <field name="domain">[]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">Create your first project!</p>
        </field>
    </record>

    <!--  This Menu Item must have a parent and an action  -->
    <menuitem id="menu_projects"
              name="Projects"
              parent="farm_root"
              action="farm_projects_action"
              sequence="10"/>

</odoo>